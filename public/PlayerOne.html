<!DOCTYPE html>
<html>
    <head>
        <title>user click Test</title>
        <meta charset="utf-8" />
        <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>

        <!-- //VERY HANDY! https://socket.io/docs/v3/emit-cheatsheet/  -->
        <script src="/socket.io/socket.io.js"></script>
        <script>
            AFRAME.registerComponent('experience-manager', {
                init: function () {
                    const socket = io();

                socket.on('connect', (userData) => {
                    console.log('I exist!');

                    //put code here so that we know that socket.io has initailized ...
                    document.querySelector('#end_button').querySelector('.button').addEventListener('click', function(){
                        socket.emit('game_end', "wall");
                    });

                });

                 //listen to event from server
                 socket.on('delete_walls', (data) => {
                    let walls = document.querySelectorAll('#' + data)
                    console.log(walls);
                    
                });

                socket.on('lightup', (data) => {
                    let changeLight = document.querySelector('#' + data);
                    console.log(changeLight);

                    if(changeLight.getAttribute('light').intensity == 4){
                        changeLight.setAttribute('light', {intensity: 0});
                    } else {
                        changeLight.setAttribute('light', {intensity: 4});
                    }
                });

                }
            })
        </script>

    </head>

    <body>
        <!-- our buttond to tell others -->
        <!-- <button id="red" style="background-color:rgb(255, 0, 0); color:rgb(255, 255, 255)">RED</button>
        <button id="blue" style="background-color:rgb(0, 0, 255); color:rgb(255, 255, 255)">BLUE</button> -->

        <a-scene experience-manager background="color:rgb(255, 255, 255);">
            <a-entity id="player" class="player" camera wasd-controls look-controls position="0 1.6 0">
                <a-entity cursor="rayOrigin:mouse;" raycaster="far:20; interval:200; objects:.interactive"></a-entity>
            </a-entity>
            <a-entity camera="fov: 25;" position="0 80 -20" rotation="-90 -90 0"></a-entity>

            <a-entity id="ground">
                <a-entity class="ground" geometry="primitive:plane; width:30; height:30;" material="color:black; roughness: 1;" position="0 0.01 -20" rotation="-90 0 0" shadow="receive: true;"></a-entity>
                <a-entity class="ground" geometry="primitive:plane; width:10; height:10;" material="color:black; roughness: 1;" position="0 0.01 0" rotation="-90 0 0" shadow="receive: true;"></a-entity>
            </a-entity>

            <a-entity id="roof">
                <a-entity class="roof" geometry="primitive:plane; width:30; height:30;" material="color:black; roughness: 1;" position="0 10 -20" rotation="90 0 0" shadow="receive: true;"></a-entity>
                <a-entity class="roof" geometry="primitive:plane; width:10; height:10;" material="color:black; roughness: 1;" position="0 10 0" rotation="90 0 0" shadow="receive: true;"></a-entity>
            </a-entity>

            <a-entity id="walls">
                <a-entity id="wallExt" geometry="primitive:plane; width:30; height:10;" material="color:black; roughness: 1;" position="0 5 -35" rotation="0 0 0" shadow></a-entity>
                <a-entity id="wallExt" geometry="primitive:plane; width:30; height:10;" material="color:black; roughness: 1;" position="-15 5 -20" rotation="0 90 0" shadow></a-entity>
                <a-entity id="wallExt" geometry="primitive:plane; width:30; height:10;" material="color:black; roughness: 1;" position="15 5 -20" rotation="0 -90 0" shadow></a-entity>

                <a-entity id="wallExt" geometry="primitive:plane; width:10; height:10;" material="color:black; roughness: 1;" position="0 5 5" rotation="0 180 0" shadow></a-entity>
                <a-entity id="wallExt" geometry="primitive:plane; width:10; height:10;" material="color:black; roughness: 1;" position="10 5 -5" rotation="0 180 0" shadow></a-entity>
                <a-entity id="wallExt" geometry="primitive:plane; width:10; height:10;" material="color:black; roughness: 1;" position="-10 5 -5" rotation="0 180 0" shadow></a-entity>
                <a-entity id="wallExt" geometry="primitive:plane; width:10; height:10;" material="color:black; roughness: 1;" position="-5 5 0" rotation="0 90 0" shadow></a-entity>
                <a-entity id="wallExt" geometry="primitive:plane; width:10; height:10;" material="color:black; roughness: 1;" position="5 5 0" rotation="0 -90 0" shadow></a-entity>
                
                <a-entity id="innerWalls" position="0 0 -20">
                    <a-entity id="wall" geometry="primitive:box; width:21; height:10; depth: 1" material="color:black; roughness: 1;" position="0 5 10" rotation="0 0 0" shadow></a-entity>
                    <a-entity id="wall" geometry="primitive:box; width:6; height:10; depth: 1" material="color:black; roughness: 1;" position="10 5 7.5" rotation="0 90 0" shadow></a-entity>
                    <a-entity id="wall" geometry="primitive:box; width:11; height:10; depth: 1" material="color:black; roughness: 1;" position="10 5 -5" rotation="0 90 0" shadow></a-entity>
                    <a-entity id="wall" geometry="primitive:box; width:6; height:10; depth: 1" material="color:black; roughness: 1;" position="12.5 5 -10" rotation="0 0 0" shadow></a-entity>
                    <a-entity id="wall" geometry="primitive:box; width:6; height:10; depth: 1" material="color:black; roughness: 1;" position="-10 5 12.5" rotation="0 90 0" shadow></a-entity>
                    <a-entity id="wall" geometry="primitive:box; width:11; height:10; depth: 1" material="color:black; roughness: 1;" position="0 5 0" rotation="0 0 0" shadow></a-entity>
                    <a-entity id="wall" geometry="primitive:box; width:11; height:10; depth: 1" material="color:black; roughness: 1;" position="0 5 5" rotation="0 0 0" shadow></a-entity>
                    <a-entity id="wall" geometry="primitive:box; width:11; height:10; depth: 1" material="color:black; roughness: 1;" position="5 5 -5" rotation="0 90 0" shadow></a-entity>
                    <a-entity id="wall" geometry="primitive:box; width:6; height:10; depth: 1" material="color:black; roughness: 1;" position="-12.5 5 5" rotation="0 0 0" shadow></a-entity>
                    <a-entity id="wall" geometry="primitive:box; width:11; height:10; depth: 1" material="color:black; roughness: 1;" position="-5 5 -5" rotation="0 90 0" shadow></a-entity>
                    <a-entity id="wall" geometry="primitive:box; width:6; height:10; depth: 1" material="color:black; roughness: 1;" position="2.5 5 -10" rotation="0 0 0" shadow></a-entity>
                    <a-entity id="wall" geometry="primitive:box; width:6; height:10; depth: 1" material="color:black; roughness: 1;" position="-12.5 5 -5" rotation="0 0 0" shadow></a-entity>
                    <a-entity id="wall" geometry="primitive:box; width:6; height:10; depth: 1" material="color:black; roughness: 1;" position="-12.5 5 0" rotation="0 0 0" shadow></a-entity>
                    <a-entity id="wall" geometry="primitive:box; width:6; height:10; depth: 1" material="color:black; roughness: 1;" position="-7.5 5 -10" rotation="0 0 0" shadow></a-entity>
                    <a-entity id="wall" geometry="primitive:box; width:6; height:10; depth: 1" material="color:black; roughness: 1;" position="5 5 -12.5" rotation="0 90 0" shadow></a-entity>
                </a-entity>

                <!--Lights-->
                <a-entity id="start_light" light="type: point; color: #FFF; intensity: 2; castShadow:true;" position="0 5 0"></a-entity>

                <a-entity id="magenta_light" light="type: point; color: #F0F; intensity: 2; castShadow:true;" position="12.5 5 -27.5"></a-entity>

                <a-entity id="green_light" light="type: point; color: #0F0; intensity: 2; castShadow:true;" position="-12.5 5 -22.5"></a-entity>

                <a-entity id="blue_light" light="type: point; color: #00F; intensity: 2; castShadow:true;" position="-2.5 5 -12.5"></a-entity>

                <a-entity id="red_light" light="type: point; color: #F00; intensity: 2; castShadow:true;" position="-12.5 5 -27.5"></a-entity>

                <a-entity id="end_light" light="type: point; color: #FFF; intensity: 2; castShadow:true;" position="2.5 5 -27.5"></a-entity>

                <a-entity id="cyan_light" light="type: point; color: #0FF; intensity: 2; castShadow:true;" position="12.5 5 -32.5"></a-entity>

                <!-- end button -->
                <a-entity id="end_button" position="2.5 0.6 -22.5"> 
                    <a-entity class="button interactive" position="0 0.6 0" geometry="primitive:cylinder; radius:0.15; height:0.2;" material="color:rgb(100, 255, 100); roughness: 1;"
                                animation__mouseenter="property:material.color; type:color; to:rgb(0, 255, 0); startEvents:mouseenter; dur:200"
                                animation__mouseleave="property:material.color; type:color; to:rgb(100, 255, 100); startEvents:mouseleave; dur:200"
                                animation__click="property:position.y; from:0.55; to:0.6; startEvents:click; dur:300" shadow></a-entity>
                    <a-entity position="0 0 0" geometry="primitive:box; width:0.5; depth:0.5; height:1.25;" material="color:rgb(255, 255, 255)" shadow></a-entity>
                </a-entity>
               
            </a-entity>

        </a-scene>
    </body>
</html>